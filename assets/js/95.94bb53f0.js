(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{443:function(s,t,e){"use strict";e.r(t);var a=e(40),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"http-time-wait-close-waitå¼‚å¸¸"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http-time-wait-close-waitå¼‚å¸¸"}},[s._v("#")]),s._v(" http - TIME_WAITï¼ŒCLOSE_WAITå¼‚å¸¸")]),s._v(" "),e("h3",{attrs:{id:"é‡åˆ°çš„é—®é¢˜"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#é‡åˆ°çš„é—®é¢˜"}},[s._v("#")]),s._v(" é‡åˆ°çš„é—®é¢˜")]),s._v(" "),e("p",[e("code",[s._v("request.js")]),s._v(" åœ¨å¯ç”¨ proxy æ¥çˆ¬å–æ•°æ®çš„æ—¶å€™ï¼Œè¿›ç¨‹çš„ "),e("code",[s._v("active handle")]),s._v(" ä¸€ç›´åœ¨å¢åŠ ã€‚")]),s._v(" "),e("h3",{attrs:{id:"æ’æŸ¥é—®é¢˜"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#æ’æŸ¥é—®é¢˜"}},[s._v("#")]),s._v(" æ’æŸ¥é—®é¢˜")]),s._v(" "),e("ol",[e("li",[s._v("ä½¿ç”¨ "),e("code",[s._v("netstat")]),s._v(" å‘½ä»¤æŸ¥çœ‹å½“å‰ tcp é“¾æ¥æƒ…å†µ")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -na "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/^tcp/ {++S["),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NF")]),s._v("]} END {for(a in S) print a, S[a]}'")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#LAST_ACK 4")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#LISTEN 16")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#CLOSE_WAIT 92 // å¾ˆå¤š!!!")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ESTABLISHED 18")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#FIN_WAIT1 3")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#FIN_WAIT2 3")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#TIME_WAIT 98 // å¾ˆå¤š!!!")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SYN_SENT 14")]),s._v("\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("p",[s._v("å¸¸ç”¨çš„ä¸‰ä¸ªçŠ¶æ€æ˜¯ï¼šESTABLISHED è¡¨ç¤ºæ­£åœ¨é€šä¿¡ï¼ŒTIME_WAIT è¡¨ç¤ºä¸»åŠ¨å…³é—­ï¼ŒCLOSE_WAIT è¡¨ç¤ºè¢«åŠ¨å…³é—­ã€‚")]),s._v(" "),e("blockquote",[e("p",[s._v("CLOSED  è¡¨ç¤ºsocketè¿æ¥æ²¡è¢«ä½¿ç”¨ã€‚"),e("br"),s._v("\nLISTENING  è¡¨ç¤ºæ­£åœ¨ç›‘å¬è¿›å…¥çš„è¿æ¥ã€‚"),e("br"),s._v("\nSYN_SENT  è¡¨ç¤ºæ­£åœ¨è¯•ç€å»ºç«‹è¿æ¥ã€‚"),e("br"),s._v("\nSYN_RECEIVED  è¿›è¡Œè¿æ¥åˆå§‹åŒæ­¥ã€‚"),e("br"),s._v("\nESTABLISHED  è¡¨ç¤ºè¿æ¥å·²è¢«å»ºç«‹ã€‚"),e("br"),s._v("\nCLOSE_WAIT  è¡¨ç¤ºè¿œç¨‹è®¡ç®—æœºå…³é—­è¿æ¥ï¼Œæ­£åœ¨ç­‰å¾…socketè¿æ¥çš„å…³é—­ã€‚"),e("br"),s._v("\nFIN_WAIT_1  è¡¨ç¤ºsocketè¿æ¥å…³é—­ï¼Œæ­£åœ¨å…³é—­è¿æ¥ã€‚"),e("br"),s._v("\nCLOSING  å…ˆå…³é—­æœ¬åœ°socketè¿æ¥ï¼Œç„¶åå…³é—­è¿œç¨‹socketè¿æ¥ï¼Œæœ€åç­‰å¾…ç¡®è®¤ä¿¡æ¯ã€‚"),e("br"),s._v("\nLAST_ACK  è¿œç¨‹è®¡ç®—æœºå…³é—­åï¼Œç­‰å¾…ç¡®è®¤ä¿¡å·ã€‚"),e("br"),s._v("\nFIN_WAIT_2  socketè¿æ¥å…³é—­åï¼Œç­‰å¾…æ¥è‡ªè¿œç¨‹è®¡ç®—æœºçš„å…³é—­ä¿¡å·ã€‚"),e("br"),s._v("\nTIME_WAIT  è¿æ¥å…³é—­åï¼Œç­‰å¾…è¿œç¨‹è®¡ç®—æœºå…³é—­é‡å‘ã€‚")])]),s._v(" "),e("p",[s._v("å¯ä»¥çœ‹åˆ°ï¼Œæœ‰å¾ˆå¤šçš„è¿æ¥æ˜¯ "),e("code",[s._v("TIME_WAIT")]),s._v(" å’Œ "),e("code",[s._v("CLOSE_WAIT")]),s._v("ï¼Œå¹¶ä¸”å­˜åœ¨å¾ˆä¹…ï¼Œå¯¼è‡´ pm2 çœ‹åˆ°å†…å­˜å ç”¨è¶Šæ¥è¶Šå¤§ï¼Œactive handle ä¹Ÿè¶Šæ¥è¶Šå¤šã€‚")]),s._v(" "),e("h3",{attrs:{id:"è§£å†³æµç¨‹"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#è§£å†³æµç¨‹"}},[s._v("#")]),s._v(" è§£å†³æµç¨‹")]),s._v(" "),e("p",[e("strong",[s._v("1. "),e("code",[s._v("TIME_WAIT")]),s._v("ï¼š")])]),s._v(" "),e("blockquote",[e("p",[s._v("è¿™ç§æƒ…å†µæ¯”è¾ƒå¸¸è§ï¼Œä¸€äº›"),e("code",[s._v("çˆ¬è™«æœåŠ¡å™¨")]),s._v("æˆ–è€…"),e("code",[s._v("WEBæœåŠ¡å™¨")]),s._v("ï¼ˆå¦‚æœç½‘ç®¡åœ¨å®‰è£…çš„æ—¶å€™æ²¡æœ‰åšå†…æ ¸å‚æ•°ä¼˜åŒ–çš„è¯ï¼‰ä¸Šç»å¸¸ä¼šé‡åˆ°è¿™ä¸ªé—®é¢˜ã€‚")])]),s._v(" "),e("p",[s._v("TIME_WAITæ˜¯ä¸»åŠ¨å…³é—­è¿æ¥çš„ä¸€æ–¹ä¿æŒçš„çŠ¶æ€ï¼Œå¯¹äºçˆ¬è™«æœåŠ¡å™¨æ¥è¯´ä»–æœ¬èº«å°±æ˜¯â€œå®¢æˆ·ç«¯â€ï¼Œåœ¨å®Œæˆä¸€ä¸ªçˆ¬å–ä»»åŠ¡ä¹‹åï¼Œä»–å°±ä¼šå‘èµ·ä¸»åŠ¨å…³é—­è¿æ¥ï¼Œä»è€Œè¿›å…¥TIME_WAITçš„çŠ¶æ€ï¼Œç„¶ååœ¨ä¿æŒè¿™ä¸ªçŠ¶æ€2MSLï¼ˆmax segment lifetimeï¼‰æ—¶é—´ä¹‹åï¼Œå½»åº•å…³é—­å›æ”¶èµ„æºã€‚ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Ÿæ˜æ˜å°±å·²ç»ä¸»åŠ¨å…³é—­è¿æ¥äº†ä¸ºå•¥è¿˜è¦ä¿æŒèµ„æºä¸€æ®µæ—¶é—´å‘¢ï¼Ÿè¿™ä¸ªæ˜¯TCP/IPçš„è®¾è®¡è€…è§„å®šçš„ï¼Œä¸»è¦å‡ºäºä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢çš„è€ƒè™‘ï¼š")]),s._v(" "),e("p",[s._v("a. é˜²æ­¢ä¸Šä¸€æ¬¡è¿æ¥ä¸­çš„åŒ…ï¼Œè¿·è·¯åé‡æ–°å‡ºç°ï¼Œå½±å“æ–°è¿æ¥ï¼ˆç»è¿‡2MSLï¼Œä¸Šä¸€æ¬¡è¿æ¥ä¸­æ‰€æœ‰çš„é‡å¤åŒ…éƒ½ä¼šæ¶ˆå¤±ï¼‰\nb. å¯é çš„å…³é—­TCPè¿æ¥ã€‚åœ¨ä¸»åŠ¨å…³é—­æ–¹å‘é€çš„æœ€åä¸€ä¸ª ack(fin) ï¼Œæœ‰å¯èƒ½ä¸¢å¤±ï¼Œè¿™æ—¶è¢«åŠ¨æ–¹ä¼šé‡æ–°å‘fin, å¦‚æœè¿™æ—¶ä¸»åŠ¨æ–¹å¤„äº CLOSED çŠ¶æ€ ï¼Œå°±ä¼šå“åº” rst è€Œä¸æ˜¯ ackã€‚æ‰€ä»¥ä¸»åŠ¨æ–¹è¦å¤„äº TIME_WAIT çŠ¶æ€ï¼Œè€Œä¸èƒ½æ˜¯ CLOSED ã€‚å¦å¤–è¿™ä¹ˆè®¾è®¡TIME_WAIT ä¼šå®šæ—¶çš„å›æ”¶èµ„æºï¼Œå¹¶ä¸ä¼šå ç”¨å¾ˆå¤§èµ„æºçš„ï¼Œé™¤éçŸ­æ—¶é—´å†…æ¥å—å¤§é‡è¯·æ±‚æˆ–è€…å—åˆ°æ”»å‡»ã€‚")]),s._v(" "),e("p",[s._v("è§£å†³æ€è·¯å¾ˆç®€å•ï¼Œå°±æ˜¯è®©æœåŠ¡å™¨èƒ½å¤Ÿå¿«é€Ÿå›æ”¶å’Œé‡ç”¨é‚£äº›TIME_WAITçš„èµ„æºã€‚")]),s._v(" "),e("p",[s._v("ä¿®æ”¹ "),e("code",[s._v("/etc/sysctl.conf")]),s._v(" æ–‡ä»¶é…ç½®ï¼Œæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶å°±æ–°å»ºä¸€ä¸ªï¼š")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("net.ipv4.tcp_keepalive_time = 200\nnet.ipv4.tcp_keepalive_probes = 3\nnet.ipv4.tcp_keepalive_intvl = 15\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("ä¿®æ”¹ä¹‹åæ‰§è¡Œ "),e("code",[s._v("/sbin/sysctl -p")]),s._v(" ä½¿å‚æ•°ç”Ÿæ•ˆã€‚")]),s._v(" "),e("p",[e("strong",[s._v("2. "),e("code",[s._v("CLOSE_WAIT")]),s._v("ï¼š")])]),s._v(" "),e("p",[s._v("TIME_WAITçŠ¶æ€å¯ä»¥é€šè¿‡ä¼˜åŒ–æœåŠ¡å™¨å‚æ•°å¾—åˆ°è§£å†³ï¼Œå› ä¸ºå‘ç”ŸTIME_WAITçš„æƒ…å†µæ˜¯æœåŠ¡å™¨è‡ªå·±å¯æ§çš„ï¼Œè¦ä¹ˆå°±æ˜¯å¯¹æ–¹è¿æ¥çš„å¼‚å¸¸ï¼Œè¦ä¹ˆå°±æ˜¯è‡ªå·±æ²¡æœ‰è¿…é€Ÿå›æ”¶èµ„æºï¼Œæ€»ä¹‹ä¸æ˜¯ç”±äºè‡ªå·±ç¨‹åºé”™è¯¯å¯¼è‡´çš„ã€‚")]),s._v(" "),e("p",[s._v("ä½†æ˜¯CLOSE_WAITå°±ä¸ä¸€æ ·äº†ï¼Œä»ä¸Šé¢çš„å›¾å¯ä»¥çœ‹å‡ºæ¥ï¼Œå¦‚æœä¸€ç›´ä¿æŒåœ¨CLOSE_WAITçŠ¶æ€ï¼Œé‚£ä¹ˆåªæœ‰ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯åœ¨å¯¹æ–¹å…³é—­è¿æ¥ä¹‹åæœåŠ¡å™¨ç¨‹åºè‡ªå·±æ²¡æœ‰è¿›ä¸€æ­¥å‘å‡ºackä¿¡å·ã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯åœ¨å¯¹æ–¹è¿æ¥å…³é—­ä¹‹åï¼Œç¨‹åºé‡Œæ²¡æœ‰æ£€æµ‹åˆ°ï¼Œæˆ–è€…ç¨‹åºå‹æ ¹å°±å¿˜è®°äº†è¿™ä¸ªæ—¶å€™éœ€è¦å…³é—­è¿æ¥ï¼Œäºæ˜¯è¿™ä¸ªèµ„æºå°±ä¸€ç›´è¢«ç¨‹åºå ç€ã€‚")]),s._v(" "),e("p",[e("strong",[s._v("æ‰€ä»¥ï¼Œæœ€åæ£€æŸ¥ä»£ç ï¼Œæ˜¯ä»£ç å±‚é¢çš„é—®é¢˜")])]),s._v(" "),e("p",[s._v("è€ƒè™‘åˆ°æœ¬æ¬¡é—®é¢˜ä¸€ä¸ªå¾ˆæ˜æ™°çš„ç‰¹ç‚¹å°±æ˜¯ï¼Œä½¿ç”¨äº†ä»£ç†æœåŠ¡å™¨å»è¯·æ±‚ "),e("code",[s._v("https")]),s._v(" çš„è¯·æ±‚ã€‚æ‰€ä»¥å°±é‡ç‚¹å…³æ³¨äº† "),e("code",[s._v("request")]),s._v(" åº“ socket,https,proxy ç›¸å…³çš„é—®é¢˜ï¼Œæœ€åæ‰¾åˆ°äº†ä¸€ä¸ª "),e("a",{attrs:{href:"https://github.com/request/request/issues/3100",target:"_blank",rel:"noopener noreferrer"}},[s._v("issue"),e("OutboundLink")],1),s._v("ã€‚å…¶å®ä¸€å¼€å§‹å°±çœ‹åˆ°äº†issueï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ²¡æœ‰æ³¨æ„ï¼Ÿï¼Ÿï¼Ÿè’¸è…¾äº†1ï¼Œ2å¤©ä¹‹åå†æ¬¡çœ‹åˆ°å®ƒ - - ğŸ˜¢")]),s._v(" "),e("p",[s._v("p.s "),e("a",{attrs:{href:"https://github.com/request/request/issues/2047#issuecomment-532753784",target:"_blank",rel:"noopener noreferrer"}},[s._v("Error: socket hang up"),e("OutboundLink")],1),s._v(" çœ‹åˆ°ä¸€ä¸ªé…ç½®ï¼Œè¯·æ±‚çš„ header é‡Œé¢ï¼Œé»˜è®¤æ˜¯ "),e("code",[s._v("keepAlive:true")]),s._v(",è¿™ä¸ªæ—¶å€™ï¼Œå¯èƒ½ä¿æŒå¾ˆå¤šsocketè¯·æ±‚ã€‚æ‰€æœ‰å¯ä»¥é…ç½®")]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" HttpsAgent "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'agentkeepalive'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("HttpsAgent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" agent "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpsAgent")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    freeSocketTimeout"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4000")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h3",{attrs:{id:"è§£å†³æ–¹æ¡ˆ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#è§£å†³æ–¹æ¡ˆ"}},[s._v("#")]),s._v(" è§£å†³æ–¹æ¡ˆ")]),s._v(" "),e("p",[s._v("æœ€ç»ˆè§£å†³æ–¹æ¡ˆï¼Œ")]),s._v(" "),e("ol",[e("li",[s._v("é’ˆå¯¹ "),e("code",[s._v("TIME_WAIT")]),s._v(" ä¿®æ”¹æœåŠ¡å™¨é…ç½®")]),s._v(" "),e("li",[s._v("é’ˆå¯¹ "),e("code",[s._v("CLOSE_WAIT")]),s._v(" è¯·æ±‚çš„æ—¶å€™è®¾ç½® headers çš„ "),e("code",[s._v("Connection: 'close''")])])]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" rp "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'request-promise'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rp")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  url"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://www.example.com'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  proxy"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://1.1.1.1:8888'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  headers"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    Connection"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'close'")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h4",{attrs:{id:"è¡¥å……"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#è¡¥å……"}},[s._v("#")]),s._v(" è¡¥å……")]),s._v(" "),e("p",[s._v("ä¸€ä¸ªå°æ’æ›²ï¼Œé’ˆå¯¹ "),e("code",[s._v("TIME_WAIT")]),s._v(" å…¶å®éƒ½æ²¡æœ‰å»è¿›è¡ŒæœåŠ¡å™¨é…ç½®çš„ä¿®æ”¹ï¼Œä½†æ˜¯æ—©ä¸Šçªç„¶å‘ç°è¿˜æœ‰å¤§é‡ "),e("code",[s._v("LAST_ACK")]),s._v(" çš„çŠ¶æ€ã€‚åº¦å¨˜äº†ä¸€ä¸‹ï¼Œå‘ç°å¥½åƒè¢«é’ˆå¯¹äº† - -ã€‚é‚è¿›è¡Œäº†ä¸€ç•ªå­¦ä¹ å’Œé…ç½®ã€‚")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# å½“keepaliveæ‰“å¼€çš„æƒ…å†µä¸‹ï¼ŒTCPå‘é€keepaliveæ¶ˆæ¯çš„é¢‘ç‡ã€‚(é»˜è®¤å€¼æ˜¯7200(2å°æ—¶)ï¼ŒæœåŠ¡å™¨å»ºè®®è®¾ä¸º1800)\nnet.ipv4.tcp_keepalive_time = 200\n# åœ¨è¿‘ç«¯ä¸¢å¼ƒTCPè¿æ¥ä¹‹å‰ï¹è¦è¿›è¡Œå¤šå°‘æ¬¡é‡è¯•ã€‚é»˜è®¤å€¼æ˜¯7ä¸ªï¹åœ¨å¤§è´Ÿè½½æœåŠ¡å™¨ä¸Šå»ºè®®è°ƒæ•´ä¸º3)\nnet.ipv4.tcp_keepalive_probes = 3\n# æ¢æµ‹æ¶ˆæ¯å‘é€çš„é¢‘ç‡ï¼Œä¹˜ä»¥tcp_keepalive_probeså°±å¾—åˆ°å¯¹äºä»å¼€å§‹æ¢æµ‹ä»¥æ¥æ²¡æœ‰å“åº”çš„è¿æ¥æ€é™¤çš„æ—¶é—´ã€‚(é»˜è®¤å€¼ä¸º75ç§’ï¼Œæ¨èè®¾ä¸º15ç§’)\nnet.ipv4.tcp_keepalive_intvl = 15\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("æœ€åè¿˜é…ç½®äº† ip é™åˆ¶ï¼Œé’ˆå¯¹å‘é€è¯·æ±‚çš„å‡ ä¸ª ip æ®µã€‚")]),s._v(" "),e("h3",{attrs:{id:"å‚è€ƒ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒ"}},[s._v("#")]),s._v(" å‚è€ƒ")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://blog.csdn.net/gisredevelopment/article/details/54930111",target:"_blank",rel:"noopener noreferrer"}},[s._v("20170208å¤§é‡Httpè¯·æ±‚close_waitçš„é—®é¢˜"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Connection",target:"_blank",rel:"noopener noreferrer"}},[s._v("Connection"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://blog.csdn.net/shootyou/article/details/6622226",target:"_blank",rel:"noopener noreferrer"}},[s._v("å†è°ˆåº”ç”¨ç¯å¢ƒä¸‹çš„TIME_WAITå’ŒCLOSE_WAIT"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://juejin.im/post/5c0cf1ed6fb9a04a08217fcc",target:"_blank",rel:"noopener noreferrer"}},[s._v("çº¿ä¸Šå¤§é‡CLOSE_WAITçš„åŸå› æ·±å…¥åˆ†æ"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=n.exports}}]);