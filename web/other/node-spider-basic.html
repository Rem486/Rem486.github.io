<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>node - 爬虫初体验 | 从零开始的Rem486</title>
  <meta name="description" content="爬虫基础知识介绍，robots.txt介绍，使用nodejs实现爬取豆瓣热映电影">
  <meta name="keywords" content="前端博客,前端知识,前端备忘录,程序员笔记,css,html,javascript,git,linux">
  <meta name="baidu-site-verification" content="utzmmiwMvm"/>
  <link rel="icon" href="/img/logo.ico">
  <meta property="article:published_time" content="2019-09-29T00:00:00.000Z"><meta property="article:modified_time" content="2020-06-02T14:05:55.000Z"><meta property="og:site_name" content="从零开始的Rem486"><meta property="og:title" content="node - 爬虫初体验"><meta property="og:description" content="爬虫基础知识介绍，robots.txt介绍，使用nodejs实现爬取豆瓣热映电影"><meta property="og:type" content="website"><meta property="og:url" content="/web/other/node-spider-basic.html"><meta name="twitter:title" content="node - 爬虫初体验"><meta name="twitter:description" content="爬虫基础知识介绍，robots.txt介绍，使用nodejs实现爬取豆瓣热映电影"><meta name="twitter:url" content="/web/other/node-spider-basic.html"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:label2" content="Filed under"><meta name="twitter:data2" content="nodejs, spider, 爬虫"><meta property="article:tag" content="nodejs"><meta property="article:tag" content="spider"><meta property="article:tag" content="爬虫">
  <link rel="preload" href="/assets/css/0.styles.ef41ae34.css" as="style"><link rel="preload" href="/assets/js/app.415dee01.js" as="script"><link rel="preload" href="/assets/js/2.3904a8d8.js" as="script"><link rel="preload" href="/assets/js/34.0c90b02b.js" as="script"><link rel="prefetch" href="/assets/js/10.0c054ad8.js"><link rel="prefetch" href="/assets/js/11.9a5bc9e9.js"><link rel="prefetch" href="/assets/js/12.872d4c05.js"><link rel="prefetch" href="/assets/js/13.9ea74b09.js"><link rel="prefetch" href="/assets/js/14.f0e24bca.js"><link rel="prefetch" href="/assets/js/15.64cbc86f.js"><link rel="prefetch" href="/assets/js/16.ecbdb137.js"><link rel="prefetch" href="/assets/js/17.296c9b13.js"><link rel="prefetch" href="/assets/js/18.8ce0cb26.js"><link rel="prefetch" href="/assets/js/19.e40747e8.js"><link rel="prefetch" href="/assets/js/20.482ed238.js"><link rel="prefetch" href="/assets/js/21.4e7e70ef.js"><link rel="prefetch" href="/assets/js/22.d8b25e64.js"><link rel="prefetch" href="/assets/js/23.d6ce72f3.js"><link rel="prefetch" href="/assets/js/24.f1fae47c.js"><link rel="prefetch" href="/assets/js/25.be56c080.js"><link rel="prefetch" href="/assets/js/26.601cacbd.js"><link rel="prefetch" href="/assets/js/27.c92aa904.js"><link rel="prefetch" href="/assets/js/28.3aa8d499.js"><link rel="prefetch" href="/assets/js/29.8b9f44f1.js"><link rel="prefetch" href="/assets/js/3.a853418b.js"><link rel="prefetch" href="/assets/js/30.df1aea91.js"><link rel="prefetch" href="/assets/js/31.1204f5fc.js"><link rel="prefetch" href="/assets/js/32.385876c2.js"><link rel="prefetch" href="/assets/js/33.d94f8d59.js"><link rel="prefetch" href="/assets/js/35.629a532a.js"><link rel="prefetch" href="/assets/js/36.21234472.js"><link rel="prefetch" href="/assets/js/37.95fb3f43.js"><link rel="prefetch" href="/assets/js/38.b25790ee.js"><link rel="prefetch" href="/assets/js/39.f82523dc.js"><link rel="prefetch" href="/assets/js/4.e8819c6a.js"><link rel="prefetch" href="/assets/js/40.454683b8.js"><link rel="prefetch" href="/assets/js/41.f562ae7f.js"><link rel="prefetch" href="/assets/js/42.d1f567a3.js"><link rel="prefetch" href="/assets/js/43.485931cc.js"><link rel="prefetch" href="/assets/js/44.96020bfc.js"><link rel="prefetch" href="/assets/js/45.dcf9b7f7.js"><link rel="prefetch" href="/assets/js/46.785e2dfb.js"><link rel="prefetch" href="/assets/js/47.927f61da.js"><link rel="prefetch" href="/assets/js/48.8e78cb4a.js"><link rel="prefetch" href="/assets/js/49.8da64f03.js"><link rel="prefetch" href="/assets/js/5.845eed76.js"><link rel="prefetch" href="/assets/js/50.98493cc9.js"><link rel="prefetch" href="/assets/js/51.0991998a.js"><link rel="prefetch" href="/assets/js/52.c49caac4.js"><link rel="prefetch" href="/assets/js/53.eee07fe0.js"><link rel="prefetch" href="/assets/js/54.abeed336.js"><link rel="prefetch" href="/assets/js/55.815e941f.js"><link rel="prefetch" href="/assets/js/56.944738bf.js"><link rel="prefetch" href="/assets/js/6.d19ca27f.js"><link rel="prefetch" href="/assets/js/7.76536608.js"><link rel="prefetch" href="/assets/js/8.27a05a6a.js"><link rel="prefetch" href="/assets/js/9.ecddd6b7.js">
  <link rel="stylesheet" href="/assets/css/0.styles.ef41ae34.css">
</head>
<body>
<div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">从零开始的Rem486</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/web/" class="nav-link router-link-active">
  前端笔记
</a></div><div class="nav-item"><a href="https://github.com/Rem486/Rem486.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/web/" class="nav-link router-link-active">
  前端笔记
</a></div><div class="nav-item"><a href="https://github.com/Rem486/Rem486.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/web/" class="sidebar-link">前端笔记</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>css</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/web/css/android-disable-img-preview.html" class="sidebar-link">禁用安卓点击图片预览</a></li><li><a href="/web/css/chrome-scroll-bar.html" class="sidebar-link">chrome自定义滚动条样式</a></li><li><a href="/web/css/css-hack.html" class="sidebar-link">css - hack</a></li><li><a href="/web/css/img-auto-size.html" class="sidebar-link">图片自适应宽高</a></li><li><a href="/web/css/inline-block-overflow-hidden.html" class="sidebar-link">inline-block 对齐</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>js</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/web/js/object-oriented-programming.html" class="sidebar-link">面向对象编程</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>移动端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/web/mobile/mobile-scroll-through.html" class="sidebar-link">滚动穿透</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/web/tool/git-set-origin-url.html" class="sidebar-link">git - 配置/修改远程仓库地址</a></li><li><a href="/web/tool/git-delete-branch.html" class="sidebar-link">git - 删除远程分支</a></li><li><a href="/web/tool/git-minor-version.html" class="sidebar-link">git - 快速获取小版本</a></li><li><a href="/web/tool/git-command.html" class="sidebar-link">git - 常用命令</a></li><li><a href="/web/tool/http-status.html" class="sidebar-link">http - 状态码</a></li><li><a href="/web/tool/http-TIME_WAIT-CLOSE_WAIT.html" class="sidebar-link">http - TIMEWAIT，CLOSEWAIT异常</a></li><li><a href="/web/tool/ssh-password-free-login.html" class="sidebar-link">ssh - 免密登录及设置多个key</a></li><li><a href="/web/tool/npm-common-use-tips.html" class="sidebar-link">npm - 常用操作技巧</a></li><li><a href="/web/tool/npm-package.json.html" class="sidebar-link">npm - package.json属性详解</a></li><li><a href="/web/tool/npm-version-management.html" class="sidebar-link">npm - 管理项目版本号</a></li><li><a href="/web/tool/reg-basic.html" class="sidebar-link">正则 - 入门</a></li><li><a href="/web/tool/reg-escape.html" class="sidebar-link">正则 - 转义特殊字符</a></li><li><a href="/web/tool/md-basic.html" class="sidebar-link">Markdown 基本语法</a></li><li><a href="/web/tool/node-version-control.html" class="sidebar-link">管理nodejs版本</a></li><li><a href="/web/tool/webpack-error.html" class="sidebar-link">webpack - 常见错误</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>数据库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/web/database/mongodb-error.html" class="sidebar-link">mongodb - 常见错误</a></li><li><a href="/web/database/mongodb-memo.html" class="sidebar-link">mongodb - 备忘录</a></li><li><a href="/web/database/mysql-start-stop.html" class="sidebar-link">mysql - 启动和关闭</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>杂项</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/web/other/article-collection.html" class="sidebar-link">文档收藏</a></li><li><a href="/web/other/node-spider-basic.html" class="active sidebar-link">node - 爬虫初体验</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web/other/node-spider-basic.html#爬虫" class="sidebar-link">爬虫</a></li><li class="sidebar-sub-header"><a href="/web/other/node-spider-basic.html#robots-txt-协议" class="sidebar-link">robots.txt 协议</a></li><li class="sidebar-sub-header"><a href="/web/other/node-spider-basic.html#爬虫的基本流程" class="sidebar-link">爬虫的基本流程</a></li><li class="sidebar-sub-header"><a href="/web/other/node-spider-basic.html#反爬虫" class="sidebar-link">反爬虫</a></li><li class="sidebar-sub-header"><a href="/web/other/node-spider-basic.html#防反爬虫" class="sidebar-link">防反爬虫</a></li><li class="sidebar-sub-header"><a href="/web/other/node-spider-basic.html#优化" class="sidebar-link">优化</a></li></ul></li><li><a href="/web/other/idea-registered.html" class="sidebar-link">idea - 注册码持续更新</a></li><li><a href="/web/other/mac-modify-host.html" class="sidebar-link">mac修改host</a></li><li><a href="/web/other/socket-error.html" class="sidebar-link">socket - 常见错误</a></li><li><a href="/web/other/websocket-basic.html" class="sidebar-link">webSocket - 入门</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="node-爬虫初体验"><a href="#node-爬虫初体验" class="header-anchor">#</a> node - 爬虫初体验</h1> <h3 id="背景介绍"><a href="#背景介绍" class="header-anchor">#</a> 背景介绍</h3> <h2 id="爬虫"><a href="#爬虫" class="header-anchor">#</a> 爬虫</h2> <p>爬虫，也叫网络蜘蛛（spider），是一种用来自动浏览万维网的网络机器人。是搜索引擎的重要组成部分，搜索引擎通过爬虫来更新自身的网站内容或其对其它网站的索引。搜索引擎将爬虫所访问的页面保存下来，然后生成索引供用户搜索。</p> <h2 id="robots-txt-协议"><a href="#robots-txt-协议" class="header-anchor">#</a> robots.txt 协议</h2> <p>robots.txt 是一个文本文件，告诉搜索引擎的爬虫，网站中的哪些内容是不应被爬虫爬取的，哪些内容是可以被爬取的，爬虫就会按照文件中的内容来确定访问范围。比如 Disallow /login, /admin 这些涉及用户敏感信息的路径，就可以告诉爬虫，这些路径是禁止爬取的（<code>律师函警告</code>）。</p> <p>所以，当一个搜索蜘蛛访问一个站点时，它会首先检查该站点根目录下是否存在robots.txt，如果存在，搜索机器人就会按照该文件中的内容来确定访问的范围；如果该文件不存在，搜索蜘蛛将能尝试访问网站上所有的页面。</p> <p>robots.txt 放在网站的根目录下。</p> <p>这个协议不是规范，只是个约定。</p> <p>爬虫应该应该在不影响目标站点运行的情况下进行爬取。</p> <p>基本写法</p> <p>【User-agent】</p> <p>爬虫种类，可以使用通配符 *，表示所欲的搜索机器人</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>User-agent: * 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>百度的搜索机器人</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>User-agent: Baiduspider
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>【Disallow】</p> <p>不允许爬取的目录</p> <p>下面代码表示禁止爬寻admin目录下面的目录</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Disallow: /admin/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>下面代码表示禁止抓取网页所有的.jpg格式的图片</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Disallow: /.jpg$
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>下面代码表示禁止爬取ab文件夹下面的adc.html文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Disallow: /ab/adc.html 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>下面代码表示禁止访问网站中所有包含问号 (?) 的网址</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Disallow: /*?* 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>下面代码表示禁止访问网站中所有页面</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Disallow: /
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>【Allow】
　　下面代码表示允许访问以&quot;.html&quot;为后缀的URL</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Allow: .html$
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>下面代码表示允许爬寻tmp的整个目录</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Allow: /tmp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>截图 豆瓣的 robots.txt</p> <p><img src="/img/node-spider-1.png" alt="豆瓣的 robots.txt"></p> <h2 id="爬虫的基本流程"><a href="#爬虫的基本流程" class="header-anchor">#</a> 爬虫的基本流程</h2> <blockquote><p>主要针对网站内容的爬取</p> <ul><li>在不影响目标站点运行的情况下，进行爬取</li></ul></blockquote> <ol><li>抓取数据</li> <li>存储数据</li> <li>渲染数据</li></ol> <p>下面以<a href="https://juejin.im/post/5ac9bc56f265da238c3af18f" target="_blank" rel="noopener noreferrer">掘金<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>上看到的抓取 <code>豆瓣电影热映影片</code> 为栗。</p> <h4 id="抓取数据"><a href="#抓取数据" class="header-anchor">#</a> 抓取数据</h4> <p>目录结构</p> <p>截图 简单的目录结构</p> <p><img src="/img/node-spider-2.png" alt="目录结构"></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>.
├─ src               // 抓取数据
│  ├─ db.js          // 数据库操作
│  ├─ index.js
│  ├─ read.js
│  └─ write.js
├─ web               // 渲染数据
│  ├─ views
│  │  └─ index.html
│  └─ server.js      
└─ package.json      // 项目依赖
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>获取内容</p> <p>根据前端后端交互的区别，这里分为两种情况</p> <ol><li><p>单页面应用 页面主要通过 ajax 请求数据之后进行渲染。现在搜索引擎的蜘蛛还不能有效爬取这种网站的内容，所以一般的内容网站都不得采用这种方式。这种网站的数据抓取相对轻松，只要 f12 找到 api，需要的数据就基本已经获取到了。也可是使用一些代理抓包工具来查看接口，如 Fiddler/Charles。</p></li> <li><p>服务端渲染 页面在服务端基本渲染好了，访问的时候直接返回的 html 代码。这种网站就需要先爬取然后解析。</p></li></ol> <p>其实就是通过请求 url ，获取到页面的 <code>html</code> 代码，然后从 <code>html</code> 里面获取数据，可以把 html 转化为 DOM 来获取，也可以正则匹配。</p> <p>这里使用 <code>request</code> 或者加强版 <code>request-promise</code> 来请求，<code>cheerio</code> 来转化 html 代码。</p> <p>然后，通过观察豆瓣电影页面，正在热映模块的 DOM 结构，找到读取内容的方法</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 引入请求库</span>
<span class="token keyword">const</span> rp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'request-promise'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 用来把 html 转化为 DOM</span>
<span class="token keyword">const</span> cheerio <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cheerio'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> opts <span class="token operator">=</span> <span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">'https://movie.douban.com'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">rp</span><span class="token punctuation">(</span>opts<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token comment">// res 就是目标页面请求回来的 html 代码</span>
  <span class="token comment">// load 返回的是一个类似 jq 的对象，操作 DOM 也和完全按照 jq 的方式。</span>
  <span class="token keyword">const</span> $ <span class="token operator">=</span> cheerio<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 结果数组</span>
  
  <span class="token comment">// 定位到 正在热映电影 模块</span>
  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#screening li.ui-slide-item'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span> item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> ele <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取 名称|评分|地址|封面|id</span>
        <span class="token keyword">let</span> name <span class="token operator">=</span> ele<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> score <span class="token operator">=</span> ele<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token string">'rate'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">'暂无评分'</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> href <span class="token operator">=</span> ele<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.poster a'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'href'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> image <span class="token operator">=</span> ele<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> id <span class="token operator">=</span> href <span class="token operator">&amp;&amp;</span> href<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/(\d+)/</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>name <span class="token operator">||</span> <span class="token operator">!</span>image <span class="token operator">||</span> <span class="token operator">!</span>href<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  
        result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          name<span class="token punctuation">,</span>
          score<span class="token punctuation">,</span>
          href<span class="token punctuation">,</span>
          image<span class="token punctuation">,</span>
          id
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p><img src="/img/node-spider-3.png" alt="豆瓣电影 - 热映 DOM 结构"></p> <blockquote><p>总结</p> <ul><li>通过 <code>request-promise</code> 获取 html 代码</li> <li><code>cheerio</code> 将 html 转化成 DOM</li> <li>操作 DOM 获取需要的电影数据(名称|评分|地址|封面|id)</li> <li>返回包含所有电影数据的数组</li></ul></blockquote> <h4 id="存储数据"><a href="#存储数据" class="header-anchor">#</a> 存储数据</h4> <p>获取到了数据，就要把数据存储起来，方便后期处理和使用。也是爬虫最主要的目的，好不容易获取到了当然要存起来。</p> <p>这里选择 mongodb 。</p> <ol><li>安装 mongodb;</li> <li>启动 mongodb 服务;</li> <li>数据库连接</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
*  数据库连接
*/</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
  db<span class="token operator">:</span> <span class="token string">'mongodb://localhost/movie_douban'</span><span class="token punctuation">,</span>
  options<span class="token operator">:</span> <span class="token punctuation">{</span>
    poolSize<span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
    auto_reconnect<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">database</span> <span class="token operator">=</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// mongoose.set('debug', true);</span>
  <span class="token comment">// 连接数据库</span>
  mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>db<span class="token punctuation">,</span> config<span class="token punctuation">.</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 连接中断重连</span>
  mongoose<span class="token punctuation">.</span>connection<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'disconnected'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 连接错误</span>
  mongoose<span class="token punctuation">.</span>connection<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 连接成功</span>
  mongoose<span class="token punctuation">.</span>connection<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Connected to mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><ol start="4"><li>定义 Schema</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 定义电影字段
 */</span>
<span class="token keyword">const</span> Schema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">;</span>
<span class="token keyword">const</span> MovieSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> String<span class="token punctuation">,</span>
  score<span class="token operator">:</span> String<span class="token punctuation">,</span>
  href<span class="token operator">:</span> String<span class="token punctuation">,</span>
  image<span class="token operator">:</span> String<span class="token punctuation">,</span>
  id<span class="token operator">:</span> Number
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
MovieSchema<span class="token punctuation">.</span>statics <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取</span>
  <span class="token keyword">async</span> <span class="token function">getMovie</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> movie <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      id<span class="token operator">:</span> id
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>movie<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'数据库查询到movie'</span><span class="token punctuation">,</span> id<span class="token punctuation">,</span> movie<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'数据库查询movie'</span><span class="token punctuation">,</span> id<span class="token punctuation">,</span> <span class="token string">'没有'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> movie<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 保存</span>
  <span class="token keyword">async</span> <span class="token function">saveMovie</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token operator">+</span>data<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
    <span class="token keyword">let</span> movie <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMovie</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>movie<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//  更新</span>
      movie <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id <span class="token punctuation">}</span><span class="token punctuation">,</span> movie<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 保存</span>
      movie <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> movie<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">async</span> <span class="token function">getMovieQuery</span> <span class="token punctuation">(</span><span class="token parameter">query</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> movies <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>movies<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> movies<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 获取movie的数据模型</span>
<span class="token keyword">const</span> Movie <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Movie'</span><span class="token punctuation">,</span> MovieSchema<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><ol start="5"><li>写入数据库</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 获取movie的数据模型</span>
<span class="token keyword">const</span> Movie <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Movie'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">write</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">movies</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> movie <span class="token keyword">of</span> movies<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过 saveMovie 保存或者更新电影</span>
    <span class="token keyword">await</span> Movie<span class="token punctuation">.</span><span class="token function">saveMovie</span><span class="token punctuation">(</span>movie<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="渲染数据"><a href="#渲染数据" class="header-anchor">#</a> 渲染数据</h4> <p>提供一个出口，把爬取到的数据展示出来。拿到了数据就可以随便玩儿了。</p> <p>这里使用 express + ejs 渲染。</p> <p>ejs 模板 <code>//index.html</code></p> <div class="language-ejs line-numbers-mode"><pre class="language-ejs"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>zh-cn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>referrer<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>no-referrer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>热映的电影<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>caption<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>正在热映的电影<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%</span><span class="token language-javascript"> <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> movies<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> movie <span class="token operator">=</span> movies<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    </span><span class="token delimiter punctuation">%&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%=</span><span class="token language-javascript">movie<span class="token punctuation">.</span>href</span><span class="token delimiter punctuation">%&gt;</span></span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>_blank<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%=</span><span class="token language-javascript">movie<span class="token punctuation">.</span>image</span><span class="token delimiter punctuation">%&gt;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%=</span><span class="token language-javascript">movie<span class="token punctuation">.</span>name</span><span class="token delimiter punctuation">%&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>score <span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%=</span><span class="token language-javascript"> movie<span class="token punctuation">.</span>scoreClass </span><span class="token delimiter punctuation">%&gt;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>评分：<span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%=</span><span class="token language-javascript">movie<span class="token punctuation">.</span>score</span><span class="token delimiter punctuation">%&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%</span><span class="token language-javascript"> <span class="token punctuation">}</span> </span><span class="token delimiter punctuation">%&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>server.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> database <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../src/db'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 连接数据库</span>
<span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Movie <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Movie'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 设置模板引擎</span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'view engine'</span><span class="token punctuation">,</span> <span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'views'</span><span class="token punctuation">,</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'views'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">engine</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ejs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__express<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 首页路由</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> movies <span class="token operator">=</span> <span class="token keyword">await</span> Movie<span class="token punctuation">.</span><span class="token function">getMovieQuery</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    movies<span class="token operator">:</span> movies<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">i</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> score <span class="token operator">=</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">;</span>
      i<span class="token punctuation">.</span>score <span class="token operator">=</span> score<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">&gt;=</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        i<span class="token punctuation">.</span>scoreClass <span class="token operator">=</span> <span class="token string">'c-1'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">&gt;=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        i<span class="token punctuation">.</span>scoreClass <span class="token operator">=</span> <span class="token string">'c-2'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        i<span class="token punctuation">.</span>scoreClass <span class="token operator">=</span> <span class="token string">'c-3'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 评分大于 7.5 的才返回</span>
      <span class="token keyword">return</span> score <span class="token operator">&amp;&amp;</span> score <span class="token operator">&gt;=</span> <span class="token number">7.5</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> b<span class="token punctuation">.</span>score <span class="token operator">-</span> a<span class="token punctuation">.</span>score<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">2333</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'app start at http://localhost:2333'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>最终效果图
<img src="/img/node-spider-4.png" alt="正在热映的电影"></p> <h2 id="反爬虫"><a href="#反爬虫" class="header-anchor">#</a> 反爬虫</h2> <p>主要介绍4种。</p> <ol><li><p>非浏览器检查
浏览器发起的请求，在请求头里面都携带各种信息，比如 <code>User-Agent</code>。而直接在服务端发起的请求是不会携带。识别 Headers 里面没有包含 User-Agent。</p></li> <li><p>限制 IP
同一 IP 短时间内过于频繁的访问。按照用户的访问行为进行限制，比如一秒钟内限制5次请求，1小时500次请求。超过次数就限制 ip 的访问。</p></li> <li><p>弹验证码
检测到异常访问的时候，弹出验证码，验证是人为行为还是机器访问。
栗子：google 搜索</p></li> <li><p>限制登录
限制页面需要登录后才可以访问，同一账号登录后请求过于频繁，采取封号的行为来限制。</p></li></ol> <h2 id="防反爬虫"><a href="#防反爬虫" class="header-anchor">#</a> 防反爬虫</h2> <p>针对前面提到的反爬虫策略进行调整方案。</p> <ol><li>非浏览器检查
请求头里面没有 User-Agent ，那就设置一个。
request-promise 代码示例</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> rp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'request-promise'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> opts <span class="token operator">=</span> <span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">'https://movie.douban.com'</span><span class="token punctuation">,</span>
  headers<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token string">'User-Agent'</span><span class="token operator">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.75 Safari/537.36'</span>
  <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">rp</span><span class="token punctuation">(</span>opts<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol start="2"><li>限制 IP
为了短时间的获得多的数据，只能高频率的访问。所以只能使用代理来进行访问，访问次数临近上限的时候就更换代理服务器。
可选的方案一般有:</li></ol> <ul><li>免费代理：度娘一下，有很多提供免费代理服务器的网站。但是可用率一般比较低。</li> <li>付费代理：可以购买一下付费的代理服务服务器。可用率据说会高一点，因为要给钱，没用过。</li> <li>代理池：就是多找几个免费代理，爬取更多的免费代理来使用。</li> <li>ADSL 拨号代理：使用 ADSL 拨号主机搭建http请求代理的服务。据说比较稳定，还是要花钱，没用过。 <a href="https://zhuanlan.zhihu.com/p/25286144" target="_blank" rel="noopener noreferrer">搭建方法可以参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>使用代理服务器进行请求的栗子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> rp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'request-promise'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> opts <span class="token operator">=</span> <span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">'https://movie.douban.com'</span><span class="token punctuation">,</span>
  proxy<span class="token operator">:</span> <span class="token string">'http://代理服务器ip:端口'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">rp</span><span class="token punctuation">(</span>opts<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol start="3"><li><p>弹验证码
验证码分为非常多种，如普通图形验证码、算术题验证码、滑动验证码、点触验证码、手机验证码、扫二维码等。
对于普通图形验证码，可以使用 OCR 识别。
其他的，简单方便的话可以对接收费的打码平台。</p></li> <li><p>限制登录
限制了登录就莫得办法咯。</p></li></ol> <ul><li>同样的数据，找一下不需要的接口来获取。</li> <li>维护 Cookies ，使用批量账号模拟登录，请求的时候随机带上 Cookies。
rp 官网栗子</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> rp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'request-promise'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> tough <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'tough-cookie'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Easy creation of the cookie - see tough-cookie docs for details</span>
<span class="token comment">// 使用 tough-cookie 创建一个类 cookie 对象 </span>
<span class="token keyword">let</span> cookie <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">tough<span class="token punctuation">.</span>Cookie</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    key<span class="token operator">:</span> <span class="token string">&quot;some_key&quot;</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">&quot;some_value&quot;</span><span class="token punctuation">,</span>
    domain<span class="token operator">:</span> <span class="token string">'api.mydomain.com'</span><span class="token punctuation">,</span>
    httpOnly<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    maxAge<span class="token operator">:</span> <span class="token number">31536000</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Put cookie in an jar which can be used across multiple requests</span>
<span class="token comment">// 把 cookie 放在 rp 的请求配置里，所有的请求都会带上 cookie </span>
<span class="token keyword">let</span> cookiejar <span class="token operator">=</span> rp<span class="token punctuation">.</span><span class="token function">jar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cookiejar<span class="token punctuation">.</span><span class="token function">setCookie</span><span class="token punctuation">(</span>cookie<span class="token punctuation">,</span> <span class="token string">'https://api.mydomain.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...all requests to https://api.mydomain.com will include the cookie</span>

<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
    uri<span class="token operator">:</span> <span class="token string">'https://api.mydomain.com/...'</span><span class="token punctuation">,</span>
    jar<span class="token operator">:</span> cookiejar <span class="token comment">// Tells rp to include cookies in jar that match uri</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">rp</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">body</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Request succeeded...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Request failed...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="优化"><a href="#优化" class="header-anchor">#</a> 优化</h2> <ol><li>多进程</li> <li>控制并发</li></ol> <h4 id="最后"><a href="#最后" class="header-anchor">#</a> 最后</h4> <p>所有分享仅用于技术学习。</p> <h3 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h3> <ul><li><a href="https://zh.wikipedia.org/wiki/%E7%B6%B2%E8%B7%AF%E7%88%AC%E8%9F%B2" target="_blank" rel="noopener noreferrer">网络爬虫<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.cnblogs.com/xiaohuochai/p/7168187.html" target="_blank" rel="noopener noreferrer">爬虫协议robots<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5ac9bc56f265da238c3af18f" target="_blank" rel="noopener noreferrer">爬虫，其实本就是这么简单<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5bce8201518825773605597d" target="_blank" rel="noopener noreferrer">这可能是你见过的最全的网络爬虫干货总结！<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">6/2/2020, 10:05:55 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/web/other/article-collection.html" class="prev">
        文档收藏
      </a></span> <span class="next"><a href="/web/other/idea-registered.html">
        idea - 注册码持续更新
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
<script src="/assets/js/app.415dee01.js" defer></script><script src="/assets/js/2.3904a8d8.js" defer></script><script src="/assets/js/34.0c90b02b.js" defer></script>
</body>
<script type="text/javascript" async
        src="https://s5.cnzz.com/z_stat.php?id=1275911745&web_id=1275911745&show=none"></script>
<script>
(function () {
  var bp = document.createElement('script');
  // var curProtocol = window.location.protocol.split(':')[0];
  // if (curProtocol === 'https') {
  //   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  // }
  // else {
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  // }
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(bp, s);
})();
</script>
</html>
